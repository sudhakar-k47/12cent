import{T as x,b as y,r as _,d as i,a as s,w as a,e as k,o as n,f as l,u as o,n as C,F as V,g as S,t as b,h as d,c as z}from"./app-03428bbd.js";import{_ as $}from"./Checkbox-44f913b4.js";import{_ as E}from"./FormSection-2a2e661f.js";import{_ as Y}from"./InputError-24c156f8.js";import{_ as w}from"./InputLabel-fc505284.js";import{_ as q}from"./TextInput-2e8454ab.js";const G={class:"mb-3"},J={key:0,class:""},K={class:"d-flex align-items-center"},O={class:"ms-2 text-sm text-muted"},Q={key:0,class:"alert alert-success mt-3"},R={key:0},W=l("p",{class:"text-muted mb-0"},"You may delete any of your existing tokens if they are no longer needed.",-1),X={class:"break-all"},Z={class:"d-flex align-items-center ms-2"},ee={key:0,class:"text-sm text-muted"},se=l("p",{class:"fs-14 text-muted"},"Please copy your new API token. For your security, it won't be shown again.",-1),te={key:0,class:"mt-4 rounded mb-4"},ae={class:"language-markup"},oe={class:"text-end"},le={class:"d-flex align-items-center"},ne={class:"ms-2 text-sm text-muted"},ie={class:"text-end"},re=l("p",{class:"fs-14"},"Are you sure you would like to delete this API token?",-1),de={class:"text-end"},ke={__name:"ApiTokenManager",props:{tokens:Array,availablePermissions:Array,defaultPermissions:Array},setup(c){const r=x({name:"",permissions:c.defaultPermissions}),p=x({permissions:[]}),A=x({}),v=y(!1),h=y(!1),B=y(null),P=y(null),f=y(!1),I=()=>{r.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{h.value=!0,r.reset()}})},D=m=>{p.permissions=m.abilities,B.value=m,v.value=!0},F=()=>{p.put(route("api-tokens.update",B.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>(B.value=null,v.value=!1)})},M=m=>{P.value=m,f.value=!0},U=()=>{A.delete(route("api-tokens.destroy",P.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>(P.value=null,f.value=!1)})};return(m,t)=>{const u=_("BButton"),N=_("BCardTitle"),j=_("BCardHeader"),H=_("BCardBody"),L=_("BCard"),T=_("BModal");return n(),i("div",null,[s(E,{onSubmitted:I,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf."},{form:a(()=>[l("div",G,[s(w,{for:"name",value:"Name"}),s(q,{id:"name",modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).name=e),type:"text",autofocus:"",class:C({"is-invalid":o(r).errors.name})},null,8,["modelValue","class"]),s(Y,{message:o(r).errors.name,class:"mt-2"},null,8,["message"])]),c.availablePermissions.length>0?(n(),i("div",J,[s(w,{for:"permissions",value:"Permissions"}),(n(!0),i(V,null,S(c.availablePermissions,e=>(n(),i("div",{key:e},[l("label",K,[s($,{checked:o(r).permissions,"onUpdate:checked":t[1]||(t[1]=g=>o(r).permissions=g),value:e},null,8,["checked","value"]),l("span",O,b(e),1)])]))),128))])):k("",!0)]),actions:a(()=>[s(u,{variant:"success w-100",type:"submit",class:C({"opacity-25":o(r).processing}),disabled:o(r).processing},{default:a(()=>[d("Create")]),_:1},8,["class","disabled"]),o(r).recentlySuccessful?(n(),i("p",Q,"Created.")):k("",!0)]),_:1}),c.tokens.length>0?(n(),i("div",R,[s(L,{"no-body":""},{default:a(()=>[s(j,null,{default:a(()=>[s(N,null,{default:a(()=>[d("Manage API Tokens")]),_:1}),W]),_:1}),s(H,{class:"p-4"},{default:a(()=>[(n(!0),i(V,null,S(c.tokens,e=>(n(),i("div",{key:e.id,class:"d-flex align-items-center justify-content-between mb-2"},[l("div",X,b(e.name),1),l("div",Z,[e.last_used_ago?(n(),i("div",ee," Last used "+b(e.last_used_ago),1)):k("",!0),c.availablePermissions.length>0?(n(),z(u,{key:1,variant:"info",class:"btn-sm me-1",onClick:g=>D(e)},{default:a(()=>[d(" Permissions ")]),_:2},1032,["onClick"])):k("",!0),s(u,{variant:"danger",class:"btn-sm",onClick:g=>M(e)},{default:a(()=>[d(" Delete ")]),_:2},1032,["onClick"])])]))),128))]),_:1})]),_:1})])):k("",!0),s(T,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e),title:"API Token","hide-footer":"","header-class":"bg-success-subtle p-3"},{default:a(()=>[se,m.$page.props.jetstream.flash.token?(n(),i("div",te,[l("pre",ae,[l("code",null,b(m.$page.props.jetstream.flash.token),1)])])):k("",!0),l("div",oe,[s(u,{variant:"danger",onClick:t[2]||(t[2]=e=>h.value=!1)},{default:a(()=>[d("Cancel")]),_:1})])]),_:1},8,["modelValue"]),s(T,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=e=>v.value=e),title:"API Token Permissions","hide-footer":""},{default:a(()=>[(n(!0),i(V,null,S(c.availablePermissions,e=>(n(),i("div",{key:e},[l("label",le,[s($,{checked:o(p).permissions,"onUpdate:checked":t[4]||(t[4]=g=>o(p).permissions=g),value:e},null,8,["checked","value"]),l("span",ne,b(e),1)])]))),128)),l("div",ie,[s(u,{variant:"danger",onClick:t[5]||(t[5]=e=>v.value=!v.value)},{default:a(()=>[d("Cancel")]),_:1}),s(u,{variant:"success",class:C(["ms-1",{"opacity-25":o(p).processing}]),disabled:o(p).processing,onClick:F},{default:a(()=>[d("Save")]),_:1},8,["class","disabled"])])]),_:1},8,["modelValue"]),s(T,{modelValue:f.value,"onUpdate:modelValue":t[8]||(t[8]=e=>f.value=e),title:"Delete API Token","header-class":"bg-danger-subtle p-2","hide-footer":""},{default:a(()=>[re,l("div",de,[s(u,{variant:"danger",class:"btn-sm",onClick:t[7]||(t[7]=e=>f.value=!f.value)},{default:a(()=>[d("Cancel")]),_:1}),s(u,{variant:"success",class:C(["ms-1 btn-sm",{"opacity-25":o(A).processing}]),disabled:o(A).processing,onClick:U},{default:a(()=>[d("Delete")]),_:1},8,["class","disabled"])])]),_:1},8,["modelValue"])])}}};export{ke as default};
