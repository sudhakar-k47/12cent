import{b as g,T as D,m as M,r as O,c as q,w as U,o as a,a as v,u as i,Z as F,f as e,l as h,X as b,d as n,g as y,t as m,n as j,F as x,e as c,k as z,a1 as A,h as J,W as w,O as E}from"./app-03428bbd.js";import{L as R}from"./main-2c5df3eb.js";import{P as H}from"./page-header-3604d849.js";import{S as G}from"./sweetalert2.all-c42e27a5.js";import{s as W}from"./default-5effbc81.js";import"./logo-light-8edeeccf.js";import"./_plugin-vue_export-helper-c27b6911.js";const X={class:"d-flex justify-content-between mb-3"},Z={class:"row"},K=["onClick"],Q={class:"ratio ratio-4x3"},Y=["src"],ee={class:"card-body d-flex flex-column justify-content-between"},te={class:"card-title text-truncate"},se={class:"badge mx-2 bg-info text-white"},oe={class:"card-text small text-muted",style:{"min-height":"3em"}},le={class:"d-flex justify-content-end gap-2"},ie=["onClick"],ae=e("i",{class:"bx bx-trash"},null,-1),ne=[ae],re={key:0,class:"col-12 text-center py-5"},ce=e("p",{class:"text-muted"},"No gallery items found",-1),de=[ce],ue={class:"mb-3"},pe=e("label",{class:"form-label"},"Title",-1),me={class:"mb-3"},_e=e("label",{class:"form-label"},"Description",-1),ge={class:"mb-3"},ve=e("label",{class:"form-label"},"Type",-1),he={key:0,class:"invalid-feedback"},fe={class:"mb-3"},be=e("label",{for:"images",class:"form-label"},"Upload Images",-1),ye=["required"],xe=e("small",{class:"text-muted"},"Supported formats: JPG, JPEG, PNG. Max size: 5MB per image",-1),we={class:"mb-3"},Ce={key:0,class:"mb-2"},ke=e("h6",{class:"text-muted"},"Existing Images",-1),Ve={class:"d-flex gap-2 flex-wrap"},Se=["src"],Be=["onClick"],Me={key:1,class:"mb-2"},Ue=e("h6",{class:"text-muted"},"New Images",-1),je={class:"d-flex gap-2 flex-wrap"},Ee=["src"],Ge=["onClick"],Ie={key:2,class:"text-center p-3 border rounded"},Le=e("i",{class:"ri-image-add-line fs-2 text-muted"},null,-1),Ne=e("p",{class:"text-muted mb-0"},"No images uploaded yet",-1),Te=[Le,Ne],$e={class:"mb-3"},Pe=e("label",{class:"form-label"},"Status",-1),De=e("option",{value:"1"},"Active",-1),Oe=e("option",{value:"0"},"Inactive",-1),qe=[De,Oe],Fe={class:"text-end"},ze=["disabled"],Ae={key:0,class:"spinner-border spinner-border-sm me-1"},Qe={__name:"Index",props:{galleries:Object},setup(I){const C=I,d=g(!1),u=g(null),p=g("");g(1);const s=D({title:"",description:"",type:"",images:[],existing_images:[],is_active:"1"}),L=M(()=>[{label:"Meeting",value:"Meeting"},{label:"Event",value:"Event"}]),k=M(()=>p.value?C.galleries.data.filter(t=>t.title.toLowerCase().includes(p.value.toLowerCase())||t.description&&t.description.toLowerCase().includes(p.value.toLowerCase())):C.galleries.data),V=(t=null)=>{s.reset(),u.value=t,t?(s.title=t.title,s.description=t.description||"",s.type=t.type,s.is_active=t.is_active?"1":"0",s.existing_images=t.images??[]):s.existing_images=[],d.value=!0},N=t=>{const o=Array.from(t.target.files);s.images=o},T=t=>typeof t=="string"?t:URL.createObjectURL(t),S=(t,o)=>{o?s.existing_images.splice(t,1):s.images.splice(t,1)},$=async()=>{try{const t=new FormData;t.append("title",s.title),t.append("description",s.description||""),t.append("type",s.type),t.append("is_active",s.is_active),s.existing_images.forEach(o=>{t.append("existing_images[]",o)}),s.images.forEach(o=>{t.append("images[]",o)}),u.value?(t.append("_method","PUT"),await w.post(`/galleries/${u.value.id}`,t)):await w.post("/galleries",t),d.value=!1,E.visit("/galleries",{preserveState:!1})}catch(t){console.error(t)}},P=t=>{G.fire({title:"Delete this gallery item?",text:t.title,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(async o=>{if(o.isConfirmed)try{await w.delete(`/galleries/${t.id}`),E.visit("/galleries",{preserveState:!1})}catch(f){console.error(f),G.fire("Error","Failed to delete the gallery item","error")}})},B=(t,o)=>t.length>o?t.slice(0,o)+"...":t;return(t,o)=>{const f=O("BModal");return a(),q(R,null,{default:U(()=>[v(i(F),{title:"Gallery"}),v(H,{title:"Gallery",pageTitle:"Manage Gallery"}),e("div",X,[h(e("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>p.value=l),class:"form-control w-25",placeholder:"Search gallery..."},null,512),[[b,p.value]]),e("button",{class:"btn btn-primary",onClick:o[1]||(o[1]=l=>V())},"Create Gallery")]),e("div",Z,[(a(!0),n(x,null,y(k.value,l=>{var r;return a(),n("div",{class:"col-md-3 mb-4",key:l.id},[e("div",{class:"card h-100 shadow-sm rounded-3 overflow-hidden cursor-pointer",onClick:_=>V(l)},[e("div",Q,[e("img",{src:(r=l.images)==null?void 0:r[0],class:"object-fit-cover w-100 h-100",alt:"gallery image",onError:o[2]||(o[2]=_=>t.event.target.src="https://via.placeholder.com/300x225?text=No+Image")},null,40,Y)]),e("div",ee,[e("div",null,[e("h5",te,m(B(l.title,100)),1),e("span",{class:j(["badge",l.is_active?"bg-success":"bg-secondary"])},m(l.is_active?"Active":"Inactive"),3),e("span",se,m(l.type),1),e("p",oe,m(B(l.description,100)),1)]),e("div",null,[e("div",le,[e("button",{class:"btn btn-sm btn-outline-danger",onClick:_=>P(l)},ne,8,ie)])])])],8,K)])}),128)),k.value.length===0?(a(),n("div",re,de)):c("",!0)]),v(f,{size:"lg",title:u.value?"Edit Gallery":"Create Gallery",modelValue:d.value,"onUpdate:modelValue":o[8]||(o[8]=l=>d.value=l),"hide-footer":""},{default:U(()=>[e("div",null,[e("form",{onSubmit:z($,["prevent"]),enctype:"multipart/form-data"},[e("div",ue,[pe,h(e("input",{"onUpdate:modelValue":o[3]||(o[3]=l=>i(s).title=l),class:"form-control",required:""},null,512),[[b,i(s).title]])]),e("div",me,[_e,h(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=l=>i(s).description=l),class:"form-control",rows:"3"},null,512),[[b,i(s).description]])]),e("div",ge,[ve,v(i(W),{modelValue:i(s).type,"onUpdate:modelValue":o[5]||(o[5]=l=>i(s).type=l),options:L.value,searchable:!0,"close-on-select":!0,placeholder:"Select Type",class:j({"is-invalid":i(s).errors.type}),required:""},null,8,["modelValue","options","class"]),i(s).errors.type?(a(),n("div",he,m(i(s).errors.type),1)):c("",!0)]),e("div",fe,[be,e("input",{type:"file",multiple:"",onChange:N,class:"form-control",id:"images",accept:"image/jpeg,image/png,image/jpg",required:!u.value||i(s).existing_images.length===0},null,40,ye),xe]),e("div",we,[i(s).existing_images.length>0?(a(),n("div",Ce,[ke,e("div",Ve,[(a(!0),n(x,null,y(i(s).existing_images,(l,r)=>(a(),n("div",{key:"existing-"+r,class:"position-relative"},[e("img",{src:l,class:"rounded",width:"100",height:"100",style:{"object-fit":"cover"}},null,8,Se),e("button",{type:"button",class:"btn-close position-absolute top-0 end-0 bg-white",onClick:_=>S(r,!0)},null,8,Be)]))),128))])])):c("",!0),i(s).images.length>0?(a(),n("div",Me,[Ue,e("div",je,[(a(!0),n(x,null,y(i(s).images,(l,r)=>(a(),n("div",{key:"new-"+r,class:"position-relative"},[e("img",{src:T(l),class:"rounded",width:"100",height:"100",style:{"object-fit":"cover"}},null,8,Ee),e("button",{type:"button",class:"btn-close position-absolute top-0 end-0 bg-white",onClick:_=>S(r,!1)},null,8,Ge)]))),128))])])):c("",!0),i(s).existing_images.length===0&&i(s).images.length===0?(a(),n("div",Ie,Te)):c("",!0)]),e("div",$e,[Pe,h(e("select",{"onUpdate:modelValue":o[6]||(o[6]=l=>i(s).is_active=l),class:"form-control"},qe,512),[[A,i(s).is_active]])]),e("div",Fe,[e("button",{type:"button",class:"btn btn-secondary me-2",onClick:o[7]||(o[7]=l=>d.value=!1)},"Cancel"),e("button",{class:"btn btn-primary",type:"submit",disabled:i(s).processing},[i(s).processing?(a(),n("span",Ae)):c("",!0),J(" Save ")],8,ze)])],32)])]),_:1},8,["title","modelValue"])]),_:1})}}};export{Qe as default};
